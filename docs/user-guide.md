# User Guide

This comprehensive guide covers all aspects of using MultipackParser for daily operations.

---

## Table of Contents

1. [Getting Started](#getting-started)
2. [Main Interface](#main-interface)
3. [Loading Pallet Data](#loading-pallet-data)
4. [Robot Communication](#robot-communication)
5. [3D Visualization](#3d-visualization)
6. [Settings and Configuration](#settings-and-configuration)
7. [UR20 Specific Features](#ur20-specific-features)
8. [Troubleshooting](#troubleshooting)
9. [Best Practices](#best-practices)

---

## Getting Started

### Launching the Application

**From Source:**
```bash
python main.py
```

**From Binary:**
```bash
./MultipackParser
```

### First Launch

On first startup, the application will:

1. Display a splash screen with loading progress
2. Create the database and configuration files
3. Show a palette configuration dialog (UR20 robots)
4. Display the main window

### Command Line Options

| Option | Description |
|--------|-------------|
| `--version`, `-v` | Display version information and exit |
| `--license`, `-l` | Display license information and exit |
| `--verbose`, `-V` | Enable debug logging for troubleshooting |
| `--no-virtual-keyboard` | Disable the Qt virtual keyboard |

**Examples:**
```bash
python main.py --version          # Check version
python main.py --verbose          # Run with debug output
python main.py --no-virtual-keyboard  # Disable virtual keyboard
```

---

## Main Interface

<div align="center">
  <img src="assets/MultipackParser-MainUI.png" alt="Main Interface" width="700">
  <p><em>Main interface of MultipackParser</em></p>
</div>

### Interface Components

| Area | Description |
|------|-------------|
| **Menu Bar** | Access to settings and system functions |
| **Status Display** | Current system status and messages |
| **Pallet Information** | Loaded pallet data, dimensions, and article number |
| **Robot Control** | Robot status indicators and control buttons |
| **3D Visualization** | Interactive 3D view of pallet layout |
| **Input Fields** | Package height, weight, and offset parameters |

### Status Indicators

The application uses color-coded indicators to show system status:

| Color | Meaning |
|-------|---------|
| **Green** | Normal operation, all systems OK |
| **Yellow** | Warning condition, attention needed |
| **Red** | Error or critical issue |
| **Black/Gray** | No data loaded or inactive |

### Navigation

The interface uses a page-based navigation system:

| Page | Purpose |
|------|---------|
| **Main Page** | Primary operations, pallet loading, robot status |
| **Settings Page** | Configuration options (password-protected) |
| **Experimental Page** | Advanced features and diagnostics |

---

## Loading Pallet Data

### Understanding Palette Plan Files

> [!NOTE]
> Palette plan files (`.rob` format) are generated by **[Multipack](https://multiscience.de/multipack-ihre-optimierungssoftware/)** software (commercial optimization software from Multiscience GmbH). Multipack creates optimized palette plans from input parameters such as box dimensions, palette dimensions, and stacking constraints.

### File Contents

Palette plan files contain:

| Data | Description |
|------|-------------|
| Palette Dimensions | Length, width, height of the palette |
| Package Dimensions | Length, width, height, and gap between packages |
| Layer Information | Number of layers and layer types |
| Package Positions | X, Y coordinates and rotation for each package |
| Layer Assignments | Which layer type applies to each layer |

### Loading from USB

1. **Insert USB Stick**
   - Ensure the USB stick contains palette plan files (`.rob` format)
   - Files should be generated by Multipack software

2. **Automatic Detection**
   - The application scans for files on startup
   - The database is updated automatically

3. **Manual Refresh**
   - Click the refresh button to scan for new files
   - Status updates to show if new palettes were found

### File Path Configuration

The default USB path is `../` (parent directory). This can be configured in settings if needed.

---

## Robot Communication

### Prerequisites

> [!IMPORTANT]
> Before using robot communication features, ensure that:
> 
> - The required **UR Program** is installed and running on your Universal Robot controller
> - The **URscript** code is properly configured to interact with the XML-RPC server
> - These robot-side components are **not included** in this repository

### Network Configuration

| Setting | Default Value |
|---------|---------------|
| Robot IP | 192.168.0.1 |
| XML-RPC Port | 50000 |
| Dashboard Port | 29999 |

Ensure network connectivity between the application and the robot.

### Robot Model Selection

Configure the robot model in settings:

| Model | Capabilities |
|-------|-------------|
| **UR10** | 2 scanners, standard operations |
| **UR20** | 3 scanners, dual palette support, intermediate layers |

### Status Monitoring

The application continuously monitors:

| Status | Description |
|--------|-------------|
| **Robot Mode** | Manual, Automatic, or Remote Control |
| **Safety Status** | Normal, Reduced Speed, Protective Stop, etc. |
| **Program State** | Stopped, Playing, Paused |
| **Scanner Status** | OK or fault condition for each scanner |

### Remote Control

1. **Enable Remote Control Mode** on the robot teach pendant
2. **Verify Status** - The application shows the current mode
3. **Send Commands** - Use the interface to start/stop programs

### Available Dashboard Commands

| Command | Action |
|---------|--------|
| `play` | Start robot program |
| `pause` | Pause robot program |
| `stop` | Stop robot program |
| `power on` | Power on the robot |
| `power off` | Power off the robot |
| `brake release` | Release robot brakes |

---

## 3D Visualization

### Viewing Pallet Layout

1. **Load Pallet Data** - Data must be loaded before visualization
2. **View 3D Canvas** - Interactive view of the pallet layout
3. **Navigate Layers** - View individual layers

### Interaction Controls

| Action | Control |
|--------|---------|
| Rotate | Click and drag |
| Zoom | Scroll wheel |
| Pan | Right-click and drag |

### Visualization Features

| Feature | Description |
|---------|-------------|
| **Color Coding** | Different colors for different layers |
| **Package Representation** | 3D boxes showing package positions |
| **Coordinate System** | Visual reference for positioning |
| **Layer Navigation** | View specific layers individually |

---

## Settings and Configuration

### Accessing Settings

1. Click the settings button in the menu
2. Enter the password when prompted
3. Navigate through settings categories

### Settings Categories

#### Info Settings
- Robot model selection (UR10/UR20)
- System information
- Usage statistics

#### Network Settings
- Connection parameters
- Server configuration

#### Audio Settings
| Setting | Description |
|---------|-------------|
| Mute/Unmute | Toggle all audio notifications |
| Volume | Adjust notification volume |
| Warning Sounds | Configure scanner warning sounds |

#### Security Settings
- Password management
- Access control

### Audio Notifications

The application provides audio feedback for various events:

| Event | Sound |
|-------|-------|
| Scanner Warning | Alert when scanners detect issues |
| Safety Events | Notifications for safety system changes |
| System Alerts | General system notifications |

---

## UR20 Specific Features

The UR20 robot model includes additional features not available on UR10.

### Dual Palette Support

UR20 supports two palettes for continuous operation:

| Palette | Status | Action |
|---------|--------|--------|
| Palette 1 | Empty/Full | Select as active |
| Palette 2 | Empty/Full | Select as active |

**Workflow:**
1. Load pallet data
2. Select active palette (1 or 2)
3. Monitor palette status
4. Request palette change when full

### Palette Change Request

When a palette is full:
1. The system detects the full condition
2. Request a palette change
3. Wait for operator to swap palettes
4. Confirm the new palette is empty
5. Continue operation

### Intermediate Layer (Zwischenlage)

Configure intermediate layer placement between pallet layers:

| Setting | Description |
|---------|-------------|
| Enable | Turn on intermediate layer placement |
| Status | Monitor current layer state |
| Clamping | Check clamping mechanism status |

### Three Scanner Support

UR20 monitors three safety scanners:

| Scanner | Position |
|---------|----------|
| Scanner 1 | Zone 1 |
| Scanner 2 | Zone 2 |
| Scanner 3 | Zone 3 |

Scanner status is displayed visually with color-coded indicators:
- **Green**: All scanners OK
- **Red/Yellow**: One or more scanners detecting issues

### Scanner Override

For maintenance or special operations, individual scanners can be overridden:
- Scanner 1 Override
- Scanner 2 Override
- Scanner 3 Override

> [!WARNING]
> Use scanner overrides with caution. Ensure proper safety procedures are followed.

---

## Troubleshooting

### Common Issues

#### Robot Not Connecting

**Symptoms:**
- Status shows "Connection Error"
- "Robot not in remote control mode" message

**Solutions:**
1. Verify robot IP address in settings
2. Check network connectivity (ping 192.168.0.1)
3. Ensure robot is powered on
4. Verify robot is in remote control mode on teach pendant
5. Check firewall settings

#### Scanner Warnings

**Symptoms:**
- Scanner status shows warnings
- Red indicators on scanner display

**Solutions:**
1. Check physical scanner connections
2. Clear any obstructions in scanner zones
3. Verify scanner override settings
4. Review robot teach pendant for scanner status

#### Data Not Loading

**Symptoms:**
- "No pallet plan loaded" message
- Empty pallet display

**Solutions:**
1. Verify USB stick is inserted and readable
2. Check file format (must be `.rob` files from Multipack)
3. Click refresh button to manually update
4. Check log files for specific errors

#### Audio Not Working

**Symptoms:**
- No sound notifications
- Warning sounds not playing

**Solutions:**
1. Check mute status in settings
2. Verify system audio is enabled
3. Check audio file paths in configuration
4. Test system audio with other applications

#### Application Not Starting

**Symptoms:**
- Application crashes on startup
- Freeze during splash screen

**Solutions:**
1. Run with verbose logging: `python main.py --verbose`
2. Check log files in `logs/` directory
3. Verify all dependencies are installed
4. Try disabling virtual keyboard: `python main.py --no-virtual-keyboard`

### Log Files

Application logs provide detailed error information:

| Log Type | Location |
|----------|----------|
| Application | `logs/multipack_parser_YYYYMMDD_HHMMSS.log` |
| Server | `logs/server_YYYYMMDD_HHMMSS.log` |

To enable debug logging:
```bash
python main.py --verbose
```

---

## Best Practices

### Daily Operations

1. **Check System Status** on startup
2. **Verify Robot Connection** before operations
3. **Monitor Scanner Status** continuously
4. **Update Pallet Data** when using new configurations

### Data Management

1. **Regular Backups** - Backup database periodically
2. **Clean USB Storage** - Remove outdated palette files
3. **Organize Files** - Use clear naming conventions

### Safety

1. **Monitor Indicators** - Watch status colors
2. **Respond to Warnings** - Address scanner issues promptly
3. **Follow Procedures** - Use proper lockout/tagout
4. **Document Issues** - Log any problems for review

### Maintenance

1. **Check Logs** - Review logs weekly for warnings
2. **Update Software** - Keep application updated
3. **Verify Network** - Ensure stable robot connection
4. **Test Audio** - Confirm warning sounds work

---

## Keyboard Shortcuts

| Shortcut | Action |
|----------|--------|
| `Ctrl+Q` | Quit application |
| `Esc` | Close dialogs |
| `F1` | Help (if available) |

---

## Next Steps

- Review the [Architecture Documentation](architecture.md) for technical details
- Check the [API Reference](api-reference.md) for integration information
- Refer to the [Installation Guide](installation.md) for setup questions

---

<div align="center">
  <sub>MultipackParser User Guide - Version 1.7.9</sub>
</div>
